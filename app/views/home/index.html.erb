<% content_for(:title) { "Two Rivers Reporter - What's Happening" } %>

<div class="home-intro">
  <h1 class="page-title">Two Rivers Reporter</h1>
  <p class="page-subtitle">
    What's happening in Two Rivers city government
    <%= link_to meetings_path, class: "search-link" do %>
      Search all meetings &#8594;
    <% end %>
  </p>
</div>

<%# === Topic Signal Cards === %>
<div class="card-grid mb-8" style="grid-template-columns: repeat(auto-fit, minmax(320px, 1fr));">
  <%# Worth Watching %>
  <div class="card card--warm">
    <div class="card-header">
      <h2 class="card-title">Worth Watching</h2>
      <p class="card-subtitle">Active topics with upcoming meetings or recent signals</p>
    </div>
    <div class="card-body">
      <% if @worth_watching.any? %>
        <% @worth_watching.each do |topic| %>
          <%= render "worth_watching_item", topic: topic %>
        <% end %>
      <% else %>
        <p class="text-muted">No active topics with upcoming meetings.</p>
      <% end %>
    </div>
    <% if @worth_watching.any? %>
      <div class="card-footer">
        <%= link_to "All topics &#8594;".html_safe, topics_path, class: "text-sm" %>
      </div>
    <% end %>
  </div>

  <%# Recent Signals %>
  <div class="card card--cool">
    <div class="card-header">
      <h2 class="card-title">Recent Signals</h2>
      <p class="card-subtitle">Topics with new continuity events in the last 30 days</p>
    </div>
    <div class="card-body">
      <% if @recent_signals.any? %>
        <% @recent_signals.each do |topic| %>
          <%= render "recent_signal_item", topic: topic %>
        <% end %>
      <% else %>
        <p class="text-muted">No recent topic activity detected.</p>
      <% end %>
    </div>
    <% if @recent_signals.any? %>
      <div class="card-footer">
        <%= link_to "All topics &#8594;".html_safe, topics_path, class: "text-sm" %>
      </div>
    <% end %>
  </div>
</div>

<hr class="home-divider">

<%# === Upcoming Meetings === %>
<section class="section">
  <div class="section-header">
    <h2 class="section-title">Upcoming Meetings</h2>
    <span class="section-time-badge">Next 30 days</span>
  </div>

  <% if @upcoming_meeting_groups.any? %>
    <% @upcoming_meeting_groups.each do |group| %>
      <%= render "meeting_week_group", group: group %>
    <% end %>
  <% else %>
    <div class="empty-state">
      <p class="mb-0">No upcoming meetings scheduled.</p>
    </div>
  <% end %>
</section>

<%# === Recently Completed === %>
<section class="section">
  <div class="section-header">
    <h2 class="section-title">Recently Completed</h2>
    <span class="section-time-badge">Past 14 days</span>
  </div>

  <% if @recent_meeting_groups.any? %>
    <% @recent_meeting_groups.each do |group| %>
      <%= render "meeting_week_group", group: group %>
    <% end %>
  <% else %>
    <div class="empty-state">
      <p class="mb-0">No recent meetings.</p>
    </div>
  <% end %>

  <div class="mt-6">
    <%= link_to meetings_path, class: "btn btn--secondary" do %>
      Search all meetings &#8594;
    <% end %>
  </div>
</section>
