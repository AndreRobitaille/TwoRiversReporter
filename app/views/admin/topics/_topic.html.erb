<tr id="<%= dom_id(topic) %>">
  <td>
    <div class="font-bold">
      <%= link_to topic.name, admin_topic_path(topic), data: { turbo_frame: "_top" } %>
    </div>
    <% if topic.topic_aliases.any? %>
      <div class="text-sm text-secondary">
        Aliases: <%= topic.topic_aliases.map(&:name).join(", ") %>
      </div>
    <% end %>
  </td>
  <td>
    <%= form_with model: [:admin, topic], class: "flex items-center gap-2", data: { controller: "inline-save", action: "submit->inline-save#submit turbo:submit-end->inline-save#end" } do |f| %>
      <%= f.number_field :importance, min: 0, max: 10, class: "form-input w-16 px-2 py-1 text-sm" %>
      <%= f.submit "Save", class: "btn btn--primary btn--sm" %>
    <% end %>
  </td>
  <td>
    <div class="text-sm">
      <%= topic.agenda_items.count %>
    </div>
  </td>
  <td>
    <%= topic.last_seen_at&.to_date %>
  </td>
  <td>
    <%= topic.last_activity_at&.to_date %>
  </td>
  <td class="text-right">
    <div class="flex gap-2 justify-end">
      <button type="button" 
              class="btn btn--secondary btn--sm" 
              data-controller="modal-trigger" 
              data-action="click->modal-trigger#open" 
              data-modal-trigger-topic-id-value="<%= topic.id %>" 
              data-modal-trigger-topic-name-value="<%= topic.name %>">
        Alias/Merge
      </button>

      <% if topic.status == "blocked" %>
        <%= button_to "Blocked", unblock_admin_topic_path(topic), method: :post, class: "btn btn--danger btn--sm" %>
      <% else %>
        <%= button_to "Approved", block_admin_topic_path(topic), method: :post, class: "btn btn--success btn--sm" %>
      <% end %>

      <% unless topic.pinned? %>
        <%= button_to "Pin", pin_admin_topic_path(topic), method: :post, class: "btn btn--secondary btn--sm" %>
      <% else %>
        <%= button_to "Unpin", unpin_admin_topic_path(topic), method: :post, class: "btn btn--primary btn--sm" %>
      <% end %>
    </div>
  </td>
</tr>
